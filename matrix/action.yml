name: Matrix

inputs:
  systems:
    description: 'Space separated list of systems to build and test the tool on.'
    required: false
    type: string
    default: 'msys mingw32 mingw64 ucrt64 clang32 clang64'
outputs:
  jobs:
    description: "List of MSYS2 systems to be used in the matrix of other jobs."
    value: ${{ steps.jobs.outputs.jobs }}

runs:
  using: 'composite'
  steps:
    - name: Generate list of jobs
      shell: python
      id: jobs
      run: |
        icons = {
          'msys':    'ðŸŸª',
          'mingw32': 'â¬›',
          'mingw64': 'ðŸŸ¦',
          'ucrt64':  'ðŸŸ¨', # Experimental!
          'clang32': 'ðŸŸ«', # Experimental!
          'clang64': 'ðŸŸ§', # Experimental!
        }
        jobs = [
            {'sys': sys.lower(), 'icon': icons[sys.lower()]}
            for sys in '${{ inputs.systems }}'.split(' ')
        ]
        print(f"::set-output name=jobs::{jobs!s}")
